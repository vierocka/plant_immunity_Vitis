---
editor: 
  markdown: 
    wrap: sentence
---

Methods Overview

1.  Plant Material and Experimental Design

Three *Vitis vinifera*â€“based genotypes carrying different combinations of resistance loci (Rpv12, Rpv12+1, Rpv12+1+3) and a susceptible control were propagated under controlled conditions.
Leaves were inoculated with *Plasmopara viticola* sporangia (50,000 spores mLâ»Â¹).
Samples were collected at 0, 6, and 24 hours post-inoculation (hpi), each with three biological replicates (36 total libraries).

2.  RNA Isolation and Sequencing

Total RNA was extracted using the Spectrumâ„¢ Plant Total RNA Kit (Sigma-Aldrich).
RNA integrity was confirmed with an Agilent Bioanalyzer.
Sequencing libraries were prepared by Novogene (UK) and sequenced on an Illumina NovaSeq platform (150 bp paired-end).

3.  Quality Control and Read Mapping

Reads were trimmed with Trimmomatic (v0.39) and quality-checked using FastQC (v0.11.9) (Trimming_mapping/QualityChecks_Trimming_mapping.sh).
Clean reads were mapped to the Vitis vinifera PN40024 v4 reference genome using STAR (v2.7.4a).
Gene-level counts were quantified with featureCounts from the subread package.

4.  Data Normalization and Batch Correction

Raw count matrices were normalized by DESeq2 and log-transformed (Batch_effects/bacth_effects.R).
Batch effects were detected and corrected using ComBat from the sva package (Batch_effects/bacth_effects.R and Batch_effects/read_checks.R and DGEA/Heteroscedasticity.R).
Principal Component Analysis (PCA) verified clustering by genotype and time, not sequencing batch.

5.  Differential Expression Analysis (DGEA)

Differentially expressed genes (DEGs) were identified per genotype and time point (DGEA/DGEA.R).
Statistical thresholds: \|logâ‚‚FoldChange\| \> 1, FDR \< 0.05.
Functional enrichment (GO, Reactome, UniProt keywords) was performed using the STRINGdb API.

6.  Gene Categorization and Pattern Classification

Each geneâ€™s temporal pattern was classified into six expression types (IEV, ER, TRS, LR, SCh, CPs) based on up/down regulation across time.
Comparisons across genotypes defined shared, recovered, and genotype-specific categories (Groups Iâ€“VI).

7.  Aggregated Expression Divergence (AED)

Transcriptomic divergence relative to the susceptible reference was computed using the mean squared difference of normalized counts (AED_analysis/DGE_bySFandCB_divergence.R).
Empirical null distributions were generated by permutation to assess statistical significance (FDR correction).
AED quantifies overall expression distance and system stabilization per genotype and time.

8.  Co-expression Network Analysis (GCNA)

Pairwise Pearson correlations were computed across 26,000 expressed genes (GCNA/GCNA_network_analysis.R).
Edges above the 99.5th percentile (r \> 0.817) defined the adjacency network.
Modules were detected using hierarchical clustering, and eigengenes correlated with genotype-time patterns.
Network topology metrics (density, clustering coefficient) were calculated with igraph.

9.  PTI/ETI Gene Classification and Cross-Talk

Homology mapping linked Arabidopsis thaliana immunity genes to Vitis orthologs (data_files/Vitis_gene_immunity_class.csv).
Genes were categorized as ETI-specific, PTI-specific, or PTIâ€“ETI shared (GCNA/create_immunity_classes.R).
Their logâ‚‚FC dynamics were visualized via clustered heatmaps (GCNA/GCNA_network_analysis.R), revealing time-resolved activation of immunity layers.

10. Statistical Modeling and Visualization

Generalized linear models (quasi-Poisson link) tested effects of genotype, time, and direction on DEG counts (transcriptional_dynamics/DEGs_counts_global_tests.R).
Pairwise contrasts were evaluated by emmeans with FDR correction.
Figures were generated in ggplot2 and pheatmap.
All analyses were performed in R 4.3.2 and documented in the public repository: ðŸ‘‰ https://github.com/vierocka/plant_immunity_Vitis
